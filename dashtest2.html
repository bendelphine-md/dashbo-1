<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Dashboard - With Funding</title>
    <style>
        :root {
            --bg-color: #F8F9FA; 
            --text-dark: #111111; 
            --text-meta: #666666;
            --card-bg: #FFFFFF;
            
            /* Chart Colors */
            --primary-blue: #2B5BA7; 
            --primary-blue-border: #1a3a6c;
            
            --light-blue: #BDD4F9;    
            --light-blue-border: #8fafe0;
            
            --grey-bar: #B0B0B0;      
            --grey-bar-border: #808080;
            
            --chart-yellow: #FFC107; 
            --chart-yellow-border: #b38600;

            /* New Color for Funding */
            --chart-green: #2E7D32; 
            --chart-green-border: #1B5E20;
            
            --border-radius: 4px;
            --font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            --focus-color: #005fcc;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: var(--font-family);
            background-color: var(--bg-color);
            color: var(--text-dark);
            line-height: 1.5;
            padding: 20px;
        }

        /* --- Accessibility --- */
        .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); border: 0; }
        .skip-link { position: absolute; top: -40px; left: 0; background: #000; color: white; padding: 8px; z-index: 2000; transition: top 0.2s; text-decoration: none; font-weight: bold; }
        .skip-link:focus { top: 0; }
        :focus-visible { outline: 3px solid var(--focus-color); outline-offset: 3px; z-index: 50; }
        abbr { text-decoration: none; border-bottom: 1px dotted #666; cursor: help; }

        /* --- Layout Container --- */
        .dashboard-wrapper {
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        /* --- Top Bar (Search) --- */
        .top-bar {
            background-color: #E6E6E6;
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 40px;
        }

        .combobox-wrapper { position: relative; max-width: 100%; }
        .combobox-wrapper::after { content: "▼"; font-size: 0.8rem; color: #555; position: absolute; right: 20px; top: 16px; pointer-events: none; }
        
        .combobox-input {
            width: 100%;
            padding: 12px 15px;
            padding-right: 40px; 
            font-size: 16px;
            border: 1px solid #ccc; 
            border-radius: var(--border-radius);
            background-color: white;
            color: #333;
            cursor: pointer; 
        }
        .combobox-input:focus { border-color: var(--focus-color); outline: none; box-shadow: 0 0 0 3px rgba(0, 95, 204, 0.3); }

        .combobox-list {
            position: absolute; top: 100%; left: 0; right: 0;
            background: white; border: 1px solid #ccc; border-top: none;
            list-style: none; margin: 0; padding: 0; max-height: 300px; overflow-y: auto;
            z-index: 100; display: none; box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .combobox-wrapper[data-expanded="true"] .combobox-list { display: block; }
        .combobox-option { padding: 12px; cursor: pointer; border-bottom: 1px solid #eee; color: #333; }
        .combobox-option:hover, .combobox-option[aria-selected="true"] { background-color: #e6f0ff; color: #000; font-weight: bold; }
        .match-text { background-color: #ffeb3b; color: #000; }

        /* --- Header Section --- */
        .project-header {
            margin-bottom: 40px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .header-left { margin-bottom: 10px; }

        .mitdp-id {
            color: #777;
            font-weight: 700;
            font-size: 0.9rem;
            text-transform: uppercase;
            margin-bottom: 5px;
            display: block;
        }

        .project-name {
            font-size: 2rem;
            font-weight: 700;
            color: #111;
            line-height: 1.1;
            margin: 0;
        }

        /* Meta Grid */
        .header-right {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .meta-item label {
            display: block;
            font-size: 0.75rem;
            color: #777;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 4px;
        }

        .meta-item span {
            font-size: 1.1rem;
            font-weight: 700;
            color: #111;
        }

        /* --- Content Grid --- */
        .main-content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 40px;
        }

        /* Summary Section */
        .summary-section { color: #222; }
        .section-label {
            font-size: 0.75rem;
            color: #777;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 15px;
            display: block;
        }
        .summary-text { white-space: pre-wrap; margin-bottom: 20px; line-height: 1.6; }
        .note { font-style: italic; color: #555; font-size: 0.9rem; }

        /* Cards Column */
        .cards-column {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .card {
            background: var(--card-bg);
            padding: 0; 
        }
        
        .card-inner {
            background-color: #FAFAFA;
            padding: 30px;
            border-radius: var(--border-radius);
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 30px;
            color: #111;
        }

        /* --- Timeline --- */
        .timeline-container { position: relative; margin-bottom: 40px; padding: 20px; background: white; border-radius: 4px; }
        
        .timeline-years { 
            display: flex; 
            justify-content: space-between; 
            font-size: 0.75rem; 
            color: #555; 
            margin-bottom: 10px; 
            position: relative; 
        }
        
        /* Dotted Lines */
        .year-marker { position: absolute; top: 25px; bottom: -10px; border-left: 1px dotted #ccc; z-index: 0; }

        .timeline-bar-track { position: relative; height: 40px; background: transparent; width: 100%; z-index: 1; margin-bottom: 20px; }
        
        .phase-bar {
            position: absolute; height: 100%; top: 0; cursor: pointer; transition: opacity 0.2s;
            border-right: 1px solid rgba(255,255,255,0.5); 
        }
        .phase-bar:hover { opacity: 0.9; z-index: 2; box-shadow: 0 0 5px rgba(0,0,0,0.2); }

        .phase-procurement { background-color: var(--grey-bar); }
        .phase-implementation { background-color: var(--primary-blue); }
        .phase-om { background-color: var(--light-blue); }

        /* Legend */
        .legend { display: flex; justify-content: center; gap: 20px; font-size: 0.85rem; color: #444; flex-wrap: wrap; margin-bottom: 20px;}
        .legend-item { display: flex; align-items: center; gap: 8px; }
        .legend-box { width: 16px; height: 16px; }
        .box-proc { background-color: var(--grey-bar); }
        .box-imp { background-color: var(--primary-blue); }
        .box-om { background-color: var(--light-blue); }

        /* Timeline Stats Grid */
        .timeline-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            text-align: center;
            gap: 20px;
            margin-top: 30px;
        }
        .timeline-stats > div:last-child { grid-column: span 2; }

        .stat-val { font-size: 1.4rem; font-weight: 700; display: block; margin-bottom: 5px; color: #111; }
        .stat-label { font-size: 0.85rem; color: #777; font-weight: 700; }

        /* --- Finance Card --- */
        .finance-wrapper {
            display: flex;
            flex-direction: column-reverse;
            gap: 20px;
            align-items: center;
            background: white;
            padding: 20px;
            border-radius: 4px;
        }
        
        .eac-display {
            text-align: center;
            width: 100%;
        }
        .eac-val { font-size: 1.5rem; font-weight: 800; color: #333; margin-bottom: 5px; }
        .eac-label { font-size: 0.85rem; color: #777; font-weight: 700; line-height: 1.2; display: block; max-width: 150px; margin: 0 auto;}

        .chart-wrapper-inner { flex-grow: 1; display: flex; flex-direction: column; width: 100%; }

        .chart-container {
            display: flex; align-items: flex-end; justify-content: center; height: 180px; gap: 20px;
            position: relative; padding-bottom: 30px; padding-top: 25px;
            border-bottom: 1px solid #eee; width: 100%;
        }
        
        .chart-grid-line { position: absolute; left: 0; right: 0; border-top: 1px dotted #ccc; z-index: 0; }
        .grid-label { position: absolute; left: 0; top: -10px; font-size: 0.7rem; color: #666; background: rgba(255,255,255,0.8); padding-right: 4px; }

        .fy-group { display: flex; align-items: flex-end; gap: 4px; position: relative; z-index: 1; height: 100%; }
        .fy-label { position: absolute; bottom: -30px; left: 0; right: 0; text-align: center; font-weight: 700; font-size: 0.8rem; color: #111; }

        .bar {
            width: 45px; transition: all 0.2s ease; position: relative; display: flex; justify-content: center; cursor: pointer;
        }
        .bar:hover { opacity: 0.9; }
        
        .bar-value-label {
            position: absolute; bottom: 5px;
            font-size: 0.75rem; font-weight: 700; color: #111;
            z-index: 2;
        }
        /* Override for darker bars to have white text */
        .bar-actual .bar-value-label, .bar-funding .bar-value-label { color: white; }

        .bar-forecast { background-color: var(--chart-yellow); }
        .bar-actual { background-color: var(--primary-blue); }
        .bar-funding { background-color: var(--chart-green); }

        .chart-legend {
            margin-top: 15px; display: flex; flex-direction: column; align-items: flex-end; gap: 5px; font-size: 0.8rem; color: #333;
        }
        .legend-row { display: flex; align-items: center; gap: 8px; }
        .legend-square { width: 12px; height: 12px; display: inline-block; }
        .sq-y { background: var(--chart-yellow); }
        .sq-b { background: var(--primary-blue); }
        .sq-g { background: var(--chart-green); }

        /* Tooltip */
        .tooltip {
            position: absolute; background-color: #333; color: #fff; padding: 8px 12px; border-radius: 4px;
            font-size: 0.85rem; pointer-events: none; z-index: 1000; display: none;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2); white-space: nowrap;
        }
        .tooltip::after { content: ""; position: absolute; top: 100%; left: 50%; margin-left: -5px; border-width: 5px; border-style: solid; border-color: #333 transparent transparent transparent; }


        /* --- DESKTOP LAYOUT --- */
        @media (min-width: 992px) {
            
            .project-header {
                flex-direction: row;
                justify-content: space-between;
                align-items: flex-start;
                margin-bottom: 50px;
            }
            .header-left { margin-bottom: 0; max-width: 600px; }
            .header-right { 
                display: flex; 
                flex-direction: row; 
                gap: 60px;
                text-align: left;
                padding-top: 5px;
            }

            .main-content {
                grid-template-columns: 30% 65%;
                gap: 5%;
            }

            .timeline-stats {
                grid-template-columns: 1fr 1fr 1fr;
            }
            .timeline-stats > div:last-child { grid-column: auto; }

            .finance-wrapper {
                flex-direction: row;
                align-items: center;
                justify-content: space-between;
            }
            .eac-display {
                width: 25%;
                text-align: center;
                padding-top: 0;
            }
            .chart-wrapper-inner {
                width: 70%;
            }
        }
        
    </style>
</head>
<body>

    <a href="#dashboardContent" class="skip-link">Skip to main content</a>
    <div id="chartTooltip" class="tooltip" aria-hidden="true"></div>

    <div class="dashboard-wrapper">
        
        <div class="top-bar">
            <div class="combobox-wrapper" id="comboboxWrapper">
                <label id="comboLabel" for="projectSearch" class="sr-only">Search or Select Project</label>
                <input type="text" id="projectSearch" class="combobox-input" role="combobox" aria-autocomplete="list" aria-expanded="false" aria-haspopup="listbox" aria-controls="projectListbox" placeholder="Select project">
                <ul id="projectListbox" role="listbox" class="combobox-list" aria-labelledby="comboLabel"></ul>
                <div id="comboStatus" class="sr-only" role="status" aria-live="polite"></div>
            </div>
        </div>

        <main id="dashboardContent" style="display:none;" tabindex="-1">
            
            <header class="project-header">
                <div class="header-left">
                    <div class="mitdp-id" id="displayId">MITDP-ID</div>
                    <h1 class="project-name" id="displayName">Project Name</h1>
                </div>
                <div class="header-right">
                    <div class="meta-item">
                        <label>Accountable Agency</label>
                        <span id="displayAgency">Agency Name</span>
                    </div>
                    <div class="meta-item">
                        <label>Project Phase</label>
                        <span id="displayPhase">Phase Name</span>
                    </div>
                </div>
            </header>

            <div class="main-content">
                <section class="summary-section" aria-labelledby="summary-heading">
                    <span id="summary-heading" class="section-label">Project Summary</span>
                    <div class="summary-text" id="displaySummary">Summary text...</div>
                    <div class="note">Note: This is a summary, contact accountable agency for detailed information.</div>
                </section>

                <section class="cards-column">
                    
                    <div class="card">
                        <div class="card-inner">
                            <h2 class="card-title">Current schedule</h2>
                            
                            <div class="timeline-container" role="img" aria-label="Project Schedule Chart">
                                <div class="timeline-years" aria-hidden="true">
                                    <span>2016</span><span>2018</span><span>2020</span><span>2022</span><span>2024</span><span>2026</span><span>2028</span><span>2030</span><span>2032</span>
                                </div>
                                <div class="timeline-bar-track" id="timelineTrack"></div>
                                
                                <div class="legend" aria-hidden="true">
                                    <div class="legend-item"><div class="legend-box box-proc"></div> Procurement</div>
                                    <div class="legend-item"><div class="legend-box box-imp"></div> Implementation</div>
                                    <div class="legend-item"><div class="legend-box box-om"></div> Operations & Maintenance</div>
                                </div>
                            </div>

                            <div class="timeline-stats">
                                <div>
                                    <span class="stat-val" id="dispLen">12 - 14 years</span>
                                    <span class="stat-label">Estimated Project Length</span>
                                </div>
                                <div>
                                    <span class="stat-val" id="dispRem">1 - 2 years</span>
                                    <span class="stat-label">Estimated Time Remaining</span>
                                </div>
                                <div>
                                    <span class="stat-val" id="dispEnd">2028</span>
                                    <span class="stat-label">Estimated End Year</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-inner">
                            <h2 class="card-title">Amount Spent</h2>
                            
                            <div class="finance-wrapper">
                                <div class="eac-display">
                                    <div class="eac-val" id="dispEAC">$75M - $80M</div>
                                    <span class="eac-label">Project Estimate-at-Completion</span>
                                </div>

                                <div class="chart-wrapper-inner">
                                    <div style="display:flex; align-items: center;">
                                        <div class="chart-container" id="chartContainer" role="graphics-document" aria-label="Spend Chart">
                                            <div class="chart-grid-line" style="bottom: 100%;" aria-hidden="true"><span class="grid-label" id="gridMax">30M</span></div>
                                            <div class="chart-grid-line" style="bottom: 50%;" aria-hidden="true"><span class="grid-label" id="gridMid">15M</span></div>

                                            <div class="fy-group">
                                                <div class="bar bar-forecast" id="bar25F"></div>
                                                <div class="bar bar-actual" id="bar25A"></div>
                                                <div class="fy-label" aria-hidden="true">FY25</div>
                                            </div>
                                            <div class="fy-group">
                                                <div class="bar bar-forecast" id="bar26F"></div>
                                                <div class="bar bar-funding" id="bar26Fund"></div>
                                                <div class="bar bar-actual" id="bar26A" style="display:none;"></div>
                                                <div class="fy-label" aria-hidden="true">FY26</div>
                                            </div>
                                        </div>
                                        
                                        <div class="chart-legend" aria-hidden="true">
                                            <div class="legend-row"><span class="legend-square sq-y"></span> Forecasted Spend</div>
                                            <div class="legend-row"><span class="legend-square sq-b"></span> Actual Spend</div>
                                            <div class="legend-row"><span class="legend-square sq-g"></span> Project Funding</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </section>
            </div>
        </main>
    </div>

<script>
    const projects = [
    {
        "MITDP ID": "DBM-23-CBIS",
        "Name": "Capital Budgeting Information System (CBIS) replacement",
        "Agency": "Department of Budget and Management",
        "Phase": "O&M",
        "Project Length": "3 - 5 years",
        "Project Len Min": 3,
        "Project Length Max": 5,
        "Start Year": 2022,
        "End Year": 2027,
        "Project Time Remaining": "0 to 1 years",
        "Procurement Start - Current": "7/1/2022",
        "Procurement End - Current": "5/1/2024",
        "Implementation Start - Current": "5/2/2024",
        "Implementation End - Current": "12/31/2025",
        "O&M Start - Current": "1/1/2026",
        "O&M End - Current": "3/31/2027",
        "EAC": "$0M - $10M",
        "FY25 Forecasted Spend": "$1,639,972.54",
        "FY25 Actual Spend": "$1,627,244",
        "FY26 Project Funding": "$0",
        "FY26 Forecasted Spend": "$1,612,821.83",
        "Project Summary": "This project, an extension of the State’s Budget Analysis and Reporting System (BARS), is focused on modernizing the management of capital projects and programs. It will replace the existing CBIS, eliminate manual processes, and introduce advanced capabilities such as facility planning and geospatial integration. The new solution will be fully integrated with BARS and the Financial Management Information System (FMIS) to ensure consistency across budgeting and accounting processes, providing a more efficient, transparent, and secure approach to managing the State’s capital budgeting activities."
    },
    {
        "MITDP ID": "COMP-22-PSM",
        "Name": "CPB Payroll System Modernization (PSM)",
        "Agency": "Comptroller of Maryland",
        "Phase": "Implementation",
        "Project Length": "5 - 7 years",
        "Project Len Min": 5,
        "Project Length Max": 7,
        "Start Year": 2021,
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start - Current": "7/1/2021",
        "Procurement End - Current": "8/30/2024",
        "Implementation Start - Current": "8/31/2024",
        "Implementation End - Current": "7/1/2026",
        "O&M Start - Current": "7/2/2026",
        "O&M End - Current": "9/30/2027",
        "EAC": "$40M - $50M",
        "FY25 Forecasted Spend": "$17,780,793.58",
        "FY25 Actual Spend": "$16,593,911",
        "FY26 Project Funding": "$19,007,550",
        "FY26 Forecasted Spend": "$20,766,900.41",
        "Project Summary": "A statewide project by the Central Payroll Bureau to replace the legacy mainframe payroll system with a modern, cloud-based Software as a Service (SaaS) solution. This transformation is designed to streamline and automate outdated payroll processes while introducing standardized industry best practices to strengthen efficiency, accuracy, and compliance. The new scalable system will serve over 100,000 employees across all branches of the State of Maryland, modernizing payroll operations and enhancing the user experience."
    },
    {
        "MITDP ID": "MDH-23-OPER",
        "Name": "OPER - Systems Integration and Modernization",
        "Agency": "Maryland Department of Health",
        "Phase": "Implementation",
        "Project Length": "4 - 6 years",
        "Project Len Min": 4,
        "Project Length Max": 6,
        "Start Year": 2022,
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start - Current": "10/3/2022",
        "Procurement End - Current": "9/30/2025",
        "Implementation Start - Current": "10/1/2025",
        "Implementation End - Current": "9/30/2026",
        "O&M Start - Current": "10/1/2026",
        "O&M End - Current": "12/31/2027",
        "EAC": "$0M - $10M",
        "FY25 Forecasted Spend": "$4,204.68",
        "FY25 Actual Spend": "$4,205",
        "FY26 Project Funding": "$2,356,598",
        "FY26 Forecasted Spend": "$2,295,120.48",
        "Project Summary": "A Maryland Department of Health (MDH) initiative to modernize licensing, compliance, and workforce regulatory functions led by the Office of Controlled Substances Administration. The project aims to enhance healthcare delivery and streamline regulatory oversight by replacing outdated manual processes with a unified, cloud-based system accessible to the public. Key benefits include strengthened data security, real-time reporting, disaster recovery, and improved efficiency and adaptability to statutory changes. It supports automated licensing and compliance for Controlled Dangerous Substances, as well as the recruitment, accreditation, and certification of Community Health Workers."
    },
    {
        "MITDP ID": "MDH-25-MMT_DASO",
        "Name": "MMT - Dental Administrative Services (DASO)",
        "Agency": "Maryland Department of Health",
        "Phase": "O&M",
        "Project Length": "8 - 10 years",
        "Project Len Min": 8,
        "Project Length Max": 10,
        "Start Year": 2018,
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start - Current": "7/1/2018",
        "Procurement End - Current": "2/3/2025",
        "Implementation Start - Current": "2/4/2025",
        "Implementation End - Current": "12/31/2025",
        "O&M Start - Current": "1/1/2026",
        "O&M End - Current": "3/31/2027",
        "EAC": "$30M - $40M",
        "FY25 Forecasted Spend": "$2,114,690.32",
        "FY25 Actual Spend": "$1,682,960",
        "FY26 Project Funding": "$17,339,778",
        "FY26 Forecasted Spend": "$7,221,271.78",
        "Project Summary": "A Maryland Department of Health (MDH) initiative under the Medicaid Enterprise Systems Modular Transformation (MMT) to improve access to dental care for Medicaid members and ensure prompt reimbursement for providers by establishing a new Dental Administrative Services Organization (DASO). The project's dual objectives are to increase annual utilization of preventive and restorative dental services by at least one percent each year, and to develop and operate a robust claims processing system that ensures accuracy and timeliness. The system is required to process electronic claims within 14 calendar days, enhancing the oral health outcomes of Medicaid members while modernizing and streamlining the administration of dental services."
    },
    {
        "MITDP ID": "MDL-22-LOCCS",
        "Name": "LABOR Omni-channel Contact Center System (LOCCS)",
        "Agency": "Department of Labor",
        "Phase": "Implementation",
        "Project Length": "5 - 7 years",
        "Project Len Min": 5,
        "Project Length Max": 7,
        "Start Year": 2021,
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start - Current": "7/1/2021",
        "Procurement End - Current": "12/14/2024",
        "Implementation Start - Current": "12/15/2024",
        "Implementation End - Current": "6/30/2026",
        "O&M Start - Current": "7/1/2026",
        "O&M End - Current": "6/30/2027",
        "EAC": "$10M - $20M",
        "FY25 Forecasted Spend": "$635,516.31",
        "FY25 Actual Spend": "$0",
        "FY26 Project Funding": "$7,009,198",
        "FY26 Forecasted Spend": "$1,653,489.29",
        "Project Summary": "A multi-phase initiative by the Maryland Department of Labor's Unemployment Insurance division to modernize and centralize contact center operations. It replaces the temporary, outsourced COVID-era call center with a State-managed, cloud-based Software as a Service (SaaS) solution. LOCCS provides omni-channel capabilities, including voice, chat, email, and self-service IVR. The solution is designed to improve customer service, streamline case handling, reduce duplicate data entry, and integrate with the existing BEACON and Salesforce platforms to deliver a modern, efficient, and resident-focused customer service model across unemployment insurance functions."
    },
    {
        "MITDP ID": "MHEC-23-FAMS",
        "Name": "New Unified Financial Aid System for Higher Education ( or MDCAPS 2.0)",
        "Agency": "Maryland Higher Education Commission",
        "Phase": "Implementation",
        "Project Length": "4 - 6 years",
        "Project Len Min": 4,
        "Project Length Max": 6,
        "Start Year": 2022,
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start - Current": "7/1/2022",
        "Procurement End - Current": "3/18/2025",
        "Implementation Start - Current": "3/25/2025",
        "Implementation End - Current": "9/18/2026",
        "O&M Start - Current": "9/21/2026",
        "O&M End - Current": "12/18/2027",
        "EAC": "$10M - $20M",
        "FY25 Forecasted Spend": "$743,327.58",
        "FY25 Actual Spend": "$731,972",
        "FY26 Project Funding": "$3,071,111",
        "FY26 Forecasted Spend": "$8,946,934.48",
        "Project Summary": "A statewide initiative by the Maryland Higher Education Commission (MHEC) to transform student access to financial aid across 29 State programs. The project implements a new web-based application that consolidates access to all scholarships, offering features like multilingual support, mobile accessibility, and electronic signatures. The system will streamline administrative functions, including processing applications, managing awards, and verifying eligibility. It aims to improve the student experience, enhance communication with real-time updates, and strengthen data-driven decision making through detailed reports and performance metrics."
    },
    {
        "MITDP ID": "SBE-24-NCRIS",
        "Name": "Campaign Reporting Information System (CRIS)",
        "Agency": "Maryland State Board of Elections",
        "Phase": "O&M",
        "Project Length": "3 - 5 years",
        "Project Len Min": 3,
        "Project Length Max": 5,
        "Start Year": 2023,
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start - Current": "7/4/2023",
        "Procurement End - Current": "1/29/2025",
        "Implementation Start - Current": "1/30/2025",
        "Implementation End - Current": "11/30/2025",
        "O&M Start - Current": "12/1/2025",
        "O&M End - Current": "12/31/2026",
        "EAC": "$0M - $10M",
        "FY25 Forecasted Spend": "$924,021.94",
        "FY25 Actual Spend": "$1,033,093",
        "FY26 Project Funding": "$521,626",
        "FY26 Forecasted Spend": "$2,601,286.23",
        "Project Summary": "The Maryland State Board of Elections (SBE) is procuring a new Campaign Reporting Information System (NCRIS) prior to the 2026 election cycle to fully manage the State’s campaign finance system. The system enables contributors and committees to self-register, document all financial activity (contributions, expenditures, loans), and electronically file reports. The SBE uses the system (currently MDCRIS) to oversee filing cycles, approve registrations, run audits on delinquent committees, and fine them. It also includes the Business Contribution Disclosure System (BCDS) module for required electronic filing of contribution disclosures by persons doing business with the State."
    },
    {
        "MITDP ID": "STO-18-FSM",
        "Name": "Financial Systems Modernization",
        "Agency": "State Treasurer's Office",
        "Phase": "Implementation",
        "Project Length": "9 - 11 years",
        "Project Len Min": 9,
        "Project Length Max": 11,
        "Start Year": 2017,
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start - Current": "7/1/2017",
        "Procurement End - Current": "9/1/2018",
        "Implementation Start - Current": "9/2/2018",
        "Implementation End - Current": "6/30/2026",
        "O&M Start - Current": "7/1/2026",
        "O&M End - Current": "6/30/2027",
        "EAC": "$30M - $40M",
        "FY25 Forecasted Spend": "$5,560,323.28",
        "FY25 Actual Spend": "$6,398,733",
        "FY26 Project Funding": "$6,199,456",
        "FY26 Forecasted Spend": "$6,539,054.07",
        "Project Summary": "A strategic initiative to transition the State Treasurer’s Office (STO) from its aging IBM AS400/i5 Treasury and Insurance Management System to a modern, cloud-based Microsoft enterprise resource planning (ERP) financial and insurance management solution. This modernization is essential to ensuring the continuity and enhancement of the Treasurer’s Office mission-critical functions, which include funds disbursement, daily cash flow management, reconciliation, ACH/wire transfers, investment of State funds, and claims management. The transition is imperative due to IBM’s end-of-service date for the legacy platform. The FSM project will deliver a secure, reliable, and scalable platform that strengthens financial management and improves efficiency."
    },
    {
        "MITDP ID": "DGS-18-EMM",
        "Name": "Maryland Marketplace (eMMA) eProcurement Solution",
        "Agency": "Department of General Services",
        "Phase": "Implementation",
        "Project Length": "10 - 12 years",
        "Project Len Min": 10,
        "Project Length Max": 12,
        "Start Year": 2017,
        "End Year": 2029,
        "Project Time Remaining": "1 to 3 years",
        "Procurement Start - Current": "7/1/2017",
        "Procurement End - Current": "2/1/2019",
        "Implementation Start - Current": "1/7/2020",
        "Implementation End - Current": "12/31/2027",
        "O&M Start - Current": "1/1/2028",
        "O&M End - Current": "12/31/2028",
        "EAC": "$70M - $80M",
        "FY25 Forecasted Spend": "$3,239,585.29",
        "FY25 Actual Spend": "$2,771,967",
        "FY26 Project Funding": "$5,353,724",
        "FY26 Forecasted Spend": "$12,557,419.76",
        "Project Summary": "This project is modernizing the State of Maryland’s enterprise procurement platform to standardize how State agencies manage solicitations, contracts, and vendor interactions. Following an internal assessment and an Executive Order, the eMMA platform is enhancing its capabilities with strategic sourcing, catalog management, advanced reporting, and improved compliance for small and minority-owned businesses. The goal is to unify procurement practices, increase accountability and transparency, and drive efficiency, equity, and innovation in Maryland’s procurement operations."
    },
    {
        "MITDP ID": "DBM-25-FLEET",
        "Name": "Fleet Management System Replacement",
        "Agency": "Department of Budget and Management",
        "Phase": "Implementation",
        "Project Length": "6 - 8 years",
        "Project Len Min": 6,
        "Project Length Max": 8,
        "Start Year": 2021,
        "End Year": 2029,
        "Project Time Remaining": "1 to 3 years",
        "Procurement Start - Current": "1/7/2021",
        "Procurement End - Current": "6/30/2025",
        "Implementation Start - Current": "7/1/2025",
        "Implementation End - Current": "3/31/2026",
        "O&M Start - Current": "4/1/2026",
        "O&M End - Current": "6/29/2027",
        "EAC": "$0M - $10M",
        "FY25 Forecasted Spend": "$200,000.00",
        "FY25 Actual Spend": "$0",
        "FY26 Project Funding": "$1,250,000",
        "FY26 Forecasted Spend": "$1,420,000.00",
        "Project Summary": "A statewide initiative by the Department of Budget and Management (DBM) to replace the legacy WebFleetMaster system with a fully functional and customizable software solution. The new system will modernize fleet operations by tracking vehicles, repairs, usage, drivers, and telematics data, and consolidating manual processes. It aims to provide enhanced reporting and dashboard capabilities and will interface with critical platforms including FMIS and eMMA. The goal is to deliver a modern, secure, and integrated fleet management solution that supports fiscal accountability."
    },
    {
        "MITDP ID": "DNR-21-ONESTOP",
        "Name": "DNR Modernization and OneStop Integration Project",
        "Agency": "Department of Natural Resources",
        "Phase": "Implementation",
        "Project Length": "8 - 10 years",
        "Project Len Min": 8,
        "Project Length Max": 10,
        "Start Year": 2019,
        "End Year": 2029,
        "Project Time Remaining": "1 to 3 years",
        "Procurement Start - Current": "10/1/2019",
        "Procurement End - Current": "10/1/2023",
        "Implementation Start - Current": "10/1/2023",
        "Implementation End - Current": "3/1/2026",
        "O&M Start - Current": "3/1/2026",
        "O&M End - Current": "6/1/2027",
        "EAC": "$20M - $30M",
        "FY25 Forecasted Spend": "$1,388,000.00",
        "FY25 Actual Spend": "$166,800",
        "FY26 Project Funding": "$0",
        "FY26 Forecasted Spend": "$4,405,550.00",
        "Project Summary": "A statewide initiative by the Department of Natural Resources (DNR) to replace the COMPASS system with a modern, web-based Commercial Off-the-Shelf (COTS) platform for comprehensive licensing and permitting services. The solution will provide a central point of access for all 134 licenses and permits, with features including online payment processing, workflow automation, and an Open Application Programming Interface (API) for integration. The project also incorporates Geographic Information System (GIS) enhancements, aiming to improve the customer experience and ensure a scalable system."
    },
    {
        "MITDP ID": "MDE-25-PORTAL",
        "Name": "MDE Portal Project",
        "Agency": "Department of the Environment",
        "Phase": "Implementation",
        "Project Length": "3 - 5 years",
        "Project Len Min": 3,
        "Project Length Max": 5,
        "Start Year": 2024,
        "End Year": 2029,
        "Project Time Remaining": "1 to 3 years",
        "Procurement Start - Current": "7/1/2024",
        "Procurement End - Current": "3/14/2025",
        "Implementation Start - Current": "3/17/2025",
        "Implementation End - Current": "3/1/2027",
        "O&M Start - Current": "3/2/2027",
        "O&M End - Current": "5/31/2028",
        "EAC": "$0M - $10M",
        "FY25 Forecasted Spend": "$287,957.32",
        "FY25 Actual Spend": "$275,078",
        "FY26 Project Funding": "$2,000,000",
        "FY26 Forecasted Spend": "$1,241,270.64",
        "Project Summary": "A modernization initiative by the Maryland Department of the Environment (MDE) to create a centralized online portal and payment system for managing permitting and licensing applications, replacing primarily paper-based processes. The portal will streamline public access to approximately 460 forms by offering structured informational pages, real-time status tracking, and integrated payment functionality. Key features include a comprehensive payment portal and support for specialized forms like the National Pollutant Discharge Elimination System (NPDES) submissions. The goal is to enhance customer service and provide a secure, user-friendly, and fully digital solution for residents and businesses needing timely and accurate environmental permitting."
    },
    {
        "MITDP ID": "MDE-25-WELLS",
        "Name": "Wells and Septic Portal",
        "Agency": "Department of the Environment",
        "Phase": "Implementation",
        "Project Length": "3 - 5 years",
        "Project Len Min": 3,
        "Project Length Max": 5,
        "Start Year": 2024,
        "End Year": 2029,
        "Project Time Remaining": "1 to 3 years",
        "Procurement Start - Current": "7/1/2024",
        "Procurement End - Current": "8/31/2025",
        "Implementation Start - Current": "9/1/2025",
        "Implementation End - Current": "8/31/2027",
        "O&M Start - Current": "9/1/2027",
        "O&M End - Current": "11/30/2028",
        "EAC": "$0M - $10M",
        "FY25 Forecasted Spend": "$200,000.00",
        "FY25 Actual Spend": "$0",
        "FY26 Project Funding": "$1,050,000",
        "FY26 Forecasted Spend": "$864,462.96",
        "Project Summary": "An MDE modernization initiative to streamline the management of on-site sewage disposal systems and well installation permits. It will deliver a comprehensive online platform enabling applicants to submit and pay for permit requests and providing automated application management tools. By digitizing the process, the portal will offer contractors and stakeholders real-time visibility into status updates, reducing delays and improving transparency. The initiative also includes informational web pages and training materials to support public awareness and effective user adoption. This effort is designed to meet all regulatory and operational requirements while enhancing efficiency, accessibility, and accountability in managing Maryland’s well and septic permitting processes."
    },
    {
        "MITDP ID": "MDH-16-EHR",
        "Name": "Statewide Electronic Health Records (EHR) system",
        "Agency": "Maryland Department of Health",
        "Phase": "Implementation",
        "Project Length": "6 - 8 years",
        "Project Len Min": 6,
        "Project Length Max": 8,
        "Start Year": 2021,
        "End Year": 2029,
        "Project Time Remaining": "1 to 3 years",
        "Procurement Start - Current": "8/6/2021",
        "Procurement End - Current": "10/1/2023",
        "Implementation Start - Current": "10/2/2023",
        "Implementation End - Current": "12/31/2026",
        "O&M Start - Current": "1/1/2027",
        "O&M End - Current": "3/31/2028",
        "EAC": "$30M - $40M",
        "FY25 Forecasted Spend": "$6,276,198.99",
        "FY25 Actual Spend": "$5,852,884",
        "FY26 Project Funding": "$1,262,665",
        "FY26 Forecasted Spend": "$8,874,155.28",
        "Project Summary": "A Maryland Department of Health (MDH) initiative to replace the legacy Health Management Information System with a commercially available, cloud-based Software as a Service (SaaS) solution. The system will support health and revenue-cycle operations across eleven State-run treatment centers, including eight behavioral health facilities and three hospitals. It will streamline patient admission, discharge, and transfer, and manage functions like revenue cycle, pharmacy, laboratory, and clinical documentation on a standardized platform. Adopting a commercial SaaS product ensures scalability and sustainability, with the goal of enhancing reporting, improving operational efficiency, and ultimately elevating the quality of patient care."
    },
    {
        "MITDP ID": "MDH-19-BON",
        "Name": "Enterprise Licensing and Regulatory Management Solution (LRMS)",
        "Agency": "Maryland Department of Health",
        "Phase": "Implementation",
        "Project Length": "4 - 6 years",
        "Project Len Min": 4,
        "Project Length Max": 6,
        "Start Year": 2023,
        "End Year": 2029,
        "Project Time Remaining": "1 to 3 years",
        "Procurement Start - Current": "7/3/2023",
        "Procurement End - Current": "8/29/2025",
        "Implementation Start - Current": "8/30/2025",
        "Implementation End - Current": "9/30/2026",
        "O&M Start - Current": "10/1/2026",
        "O&M End - Current": "12/30/2027",
        "EAC": "$10M - $20M",
        "FY25 Forecasted Spend": "$193,832.32",
        "FY25 Actual Spend": "$226,672",
        "FY26 Project Funding": "$1,714,229",
        "FY26 Forecasted Spend": "$3,628,332.95",
        "Project Summary": "An MDH initiative to enhance the ability of the Maryland Board of Nursing (MBON) to manage health profession services and regulatory functions. It establishes a modern, scalable enterprise platform that will first support the MBON and then be extended to the State’s twenty-two other health profession boards. The solution strengthens public health and safety by enabling more effective credentialing, permitting, licensing, examination, inspection, and discipline of healthcare providers and facilities. By providing a consistent and scalable system, the project advances Maryland’s ability to regulate health professions with greater efficiency, accountability, and transparency."
    },
    {
        "MITDP ID": "COMP-16-ITS",
        "Name": "Integrated Tax System",
        "Agency": "Comptroller of Maryland",
        "Phase": "Implementation",
        "Project Length": "12 - 14 years",
        "Project Len Min": 12,
        "Project Length Max": 14,
        "Start Year": 2016,
        "End Year": 2028,
        "Project Time Remaining": "1 - 2 years",
        "Procurement Start - Current": "7/1/2016",
        "Procurement End - Current": "9/1/2020",
        "Implementation Start - Current": "9/2/2020",
        "Implementation End - Current": "12/31/2026",
        "O&M Start - Current": "1/1/2027",
        "O&M End - Current": "6/30/2028",
        "EAC": "$75M - $80M",
        "FY25 Forecasted Spend": "$20000000",
        "FY25 Actual Spend": "$17000000",
        "FY26 Project Funding": "$0",
        "FY26 Forecasted Spend": "$20000000",
        "Project Summary": "Modernizing tax administration by replacing legacy systems with RSI's cloud-based Revenue Premier. Enhances efficiency, transparency, and taxpayer services through integration with Maryland's data warehouse for improved querying, auditing, reporting, fraud detection, and forecasting. The phased rollout includes: Release one (2020-2021) for Alcohol and Corporate Income Taxes; Release two (Q3 FY24) for major taxes (Withholding, Sales and Use, Tobacco, Motor Fuel); and Release three (late FY26) for personal and miscellaneous taxes."
    }
    ];

    const parseCurrency = (str) => {
        if(!str) return 0;
        return parseFloat(str.replace(/[^0-9.-]+/g,""));
    };

    const getDateVal = (dateStr) => {
        const d = new Date(dateStr);
        if(isNaN(d)) return 0;
        const year = d.getFullYear();
        const startOfYear = new Date(year, 0, 1);
        const endOfYear = new Date(year + 1, 0, 1);
        const yearDuration = endOfYear - startOfYear;
        const passed = d - startOfYear;
        return year + (passed / yearDuration);
    };

    const fmtMillions = (val) => {
        if(val >= 1000000) return Math.round(val/1000000) + "M";
        if(val >= 1000) return Math.round(val/1000) + "K";
        return val;
    };

    const fmtDecimal = (val) => {
        if(val >= 1000000) return (val/1000000).toFixed(1) + "M";
        if(val >= 1000) return Math.round(val/1000) + "K";
        return Math.round(val);
    };

    const fmtExact = (val) => {
        return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0 }).format(val);
    };

    const selectEl = document.getElementById('projectSelect');
    const contentArea = document.getElementById('dashboardContent');
    const tooltipEl = document.getElementById('chartTooltip');

    const wrapper = document.getElementById('comboboxWrapper');
    const input = document.getElementById('projectSearch');
    const listbox = document.getElementById('projectListbox');
    const status = document.getElementById('comboStatus');
    let activeIndex = -1;
    let filteredProjects = [];
    let allOptionsCache = [];

    window.addEventListener('DOMContentLoaded', () => {
        allOptionsCache = projects.map((p, i) => {
            return { originalIndex: i, label: `${p["MITDP ID"]} ${p.Name}` };
        });

        const defaultIndex = projects.findIndex(p => p["MITDP ID"] === "COMP-16-ITS");
        const idx = defaultIndex > -1 ? defaultIndex : 0;
        renderProject(projects[idx]);
    });

    function showAllOptions() {
        renderOptions(allOptionsCache, ''); 
        filteredProjects = allOptionsCache; 
    }

    function filterOptions(query) {
        const q = query.toLowerCase();
        filteredProjects = allOptionsCache.filter(item => item.label.toLowerCase().includes(q));
        renderOptions(filteredProjects, q);
    }

    function renderOptions(items, query) {
        listbox.innerHTML = '';
        if (items.length === 0) {
            const li = document.createElement('li');
            li.className = 'combobox-option';
            li.textContent = 'No results found';
            listbox.appendChild(li);
            status.textContent = 'No results found';
            return;
        }

        status.textContent = `${items.length} results available. Use up and down arrow keys to navigate.`;

        items.forEach((item, index) => {
            const li = document.createElement('li');
            li.id = `option-${index}`;
            li.className = 'combobox-option';
            li.setAttribute('role', 'option');
            li.setAttribute('aria-selected', 'false');
            
            if(query) {
                const regex = new RegExp(`(${query})`, 'gi');
                li.innerHTML = item.label.replace(regex, '<span class="match-text">$1</span>');
            } else {
                li.textContent = item.label;
            }

            li.addEventListener('mousedown', (e) => {
                e.preventDefault(); 
                selectOption(item);
            });

            listbox.appendChild(li);
        });
    }

    function selectOption(item) {
        input.value = item.label;
        renderProject(projects[item.originalIndex]);
        closeListbox();
        input.focus(); 
    }

    function openListbox() {
        wrapper.setAttribute('data-expanded', 'true');
        input.setAttribute('aria-expanded', 'true');
        if(input.value.trim() === '') showAllOptions();
        else filterOptions(input.value);
    }

    function closeListbox() {
        wrapper.setAttribute('data-expanded', 'false');
        input.setAttribute('aria-expanded', 'false');
        activeIndex = -1;
        input.setAttribute('aria-activedescendant', '');
    }

    function setActiveOption(index) {
        const options = listbox.querySelectorAll('[role="option"]');
        if (options.length === 0) return;
        options.forEach(opt => {
            opt.setAttribute('aria-selected', 'false');
            opt.classList.remove('active');
        });
        if (index >= 0 && index < options.length) {
            const activeOpt = options[index];
            activeOpt.setAttribute('aria-selected', 'true');
            input.setAttribute('aria-activedescendant', activeOpt.id);
            activeOpt.scrollIntoView({ block: 'nearest' });
        }
    }

    input.addEventListener('click', () => {
        input.value = '';
        showAllOptions(); 
        openListbox();    
    });

    input.addEventListener('input', (e) => {
        openListbox();
        if(e.target.value.trim() === '') showAllOptions();
        else filterOptions(e.target.value);
        activeIndex = -1;
    });

    input.addEventListener('keydown', (e) => {
        const options = listbox.querySelectorAll('[role="option"]');
        switch(e.key) {
            case 'ArrowDown':
                e.preventDefault();
                if (wrapper.getAttribute('data-expanded') !== 'true') openListbox();
                activeIndex = (activeIndex + 1) % options.length;
                setActiveOption(activeIndex);
                break;
            case 'ArrowUp':
                e.preventDefault();
                if (wrapper.getAttribute('data-expanded') !== 'true') return;
                activeIndex = (activeIndex - 1 + options.length) % options.length;
                setActiveOption(activeIndex);
                break;
            case 'Enter':
                e.preventDefault();
                if (activeIndex >= 0 && options[activeIndex]) {
                    if(filteredProjects[activeIndex]) selectOption(filteredProjects[activeIndex]);
                }
                break;
            case 'Escape':
                e.preventDefault();
                closeListbox();
                break;
            case 'Tab':
                closeListbox();
                break;
        }
    });

    document.addEventListener('click', (e) => {
        if (!wrapper.contains(e.target)) closeListbox();
    });

    function renderProject(p) {
        contentArea.style.display = 'block';

        document.getElementById('displayId').innerHTML = p["MITDP ID"];
        document.getElementById('displayName').textContent = p.Name;
        document.getElementById('displayAgency').textContent = p.Agency;
        document.getElementById('displayPhase').textContent = p.Phase;
        document.getElementById('displaySummary').textContent = p["Project Summary"];
        document.getElementById('dispLen').textContent = p["Project Length"];
        document.getElementById('dispRem').textContent = p["Project Time Remaining"];
        document.getElementById('dispEnd').textContent = p["End Year"];
        document.getElementById('dispEAC').textContent = p.EAC;

        const positionTooltip = (e, targetEl) => {
            const rect = targetEl.getBoundingClientRect();
            const tipRect = tooltipEl.getBoundingClientRect();
            let top = rect.top + window.scrollY - tipRect.height - 8; 
            let left = rect.left + window.scrollX + (rect.width / 2) - (tipRect.width / 2);
            tooltipEl.style.top = top + 'px';
            tooltipEl.style.left = left + 'px';
        };

        // Timeline Logic
        const timelineStart = 2016;
        const timelineEnd = 2032; 
        const totalDuration = timelineEnd - timelineStart;

        const getLeft = (dateVal) => ((dateVal - timelineStart) / totalDuration) * 100;
        const getWidth = (start, end) => ((end - start) / totalDuration) * 100;

        const procStart = getDateVal(p["Procurement Start - Current"]);
        const procEnd = getDateVal(p["Procurement End - Current"]);
        const impStart = getDateVal(p["Implementation Start - Current"]);
        const impEnd = getDateVal(p["Implementation End - Current"]);
        const omStart = getDateVal(p["O&M Start - Current"]);
        const omEnd = getDateVal(p["O&M End - Current"]);

        const track = document.getElementById('timelineTrack');
        track.innerHTML = '';

        const addPhaseBar = (start, end, className, label, dateStartStr, dateEndStr) => {
            if(end <= start) return;
            if(end < timelineStart || start > timelineEnd) return; 

            const div = document.createElement('div');
            div.className = `phase-bar ${className}`;
            div.style.left = Math.max(0, getLeft(start)) + '%';
            div.style.width = getWidth(start, end) + '%';
            
            div.setAttribute('tabindex', '0');
            div.setAttribute('role', 'graphics-symbol');
            div.setAttribute('aria-label', `${label} Phase: ${dateStartStr} to ${dateEndStr}`);
            
            track.appendChild(div);

            div.onmouseenter = (e) => {
                tooltipEl.innerHTML = `<strong>${label}</strong><br>${dateStartStr} - ${dateEndStr}`;
                tooltipEl.style.display = 'block';
                positionTooltip(e, div);
            };
            div.onmousemove = (e) => positionTooltip(e, div);
            div.onmouseleave = () => tooltipEl.style.display = 'none';

            div.onfocus = (e) => {
                tooltipEl.innerHTML = `<strong>${label}</strong><br>${dateStartStr} - ${dateEndStr}`;
                tooltipEl.style.display = 'block';
                positionTooltip(e, div);
            };
            div.onblur = () => tooltipEl.style.display = 'none';
        };

        addPhaseBar(procStart, procEnd, 'phase-procurement', 'Procurement', p["Procurement Start - Current"], p["Procurement End - Current"]);
        addPhaseBar(impStart, impEnd, 'phase-implementation', 'Implementation', p["Implementation Start - Current"], p["Implementation End - Current"]);
        addPhaseBar(omStart, omEnd, 'phase-om', 'Operations & Maintenance', p["O&M Start - Current"], p["O&M End - Current"]);

        // Chart Logic
        const v25F = parseCurrency(p["FY25 Forecasted Spend"]);
        const v25A = parseCurrency(p["FY25 Actual Spend"]);
        const v26F = parseCurrency(p["FY26 Forecasted Spend"]);
        const v26A = 0; 
        const v26Fund = parseCurrency(p["FY26 Project Funding"]); // Get funding value

        let maxVal = Math.max(v25F, v25A, v26F, v26A, v26Fund); // Include funding in scale
        if(maxVal === 0) maxVal = 100;
        const scaleMax = maxVal * 1.2;

        document.getElementById('gridMax').textContent = fmtMillions(scaleMax);
        document.getElementById('gridMid').textContent = fmtMillions(scaleMax / 2);

        const setBar = (id, val, rawString, headerLabel) => {
            const el = document.getElementById(id);
            const pct = (val / scaleMax) * 100;
            el.style.height = pct + '%';
            
            el.innerHTML = '';
            if (val > 0) {
                const label = document.createElement('div');
                label.className = 'bar-value-label';
                label.textContent = fmtDecimal(val);
                el.appendChild(label);
            }
            
            if(val === 0) el.style.display = 'none';
            else el.style.display = 'flex';

            let tooltipText = rawString;
            if(!tooltipText || tooltipText === "0" || tooltipText === "$0") {
                tooltipText = fmtExact(val);
            }

            el.setAttribute('tabindex', '0');
            el.setAttribute('role', 'graphics-symbol');
            el.setAttribute('aria-label', `${headerLabel}: ${tooltipText}`);

            el.onmouseenter = (e) => {
                tooltipEl.innerHTML = `<strong>${headerLabel}</strong><br>${tooltipText}`;
                tooltipEl.style.display = 'block';
                positionTooltip(e, el);
            };
            el.onmousemove = (e) => positionTooltip(e, el);
            el.onmouseleave = () => tooltipEl.style.display = 'none';

            el.onfocus = (e) => {
                tooltipEl.innerHTML = `<strong>${headerLabel}</strong><br>${tooltipText}`;
                tooltipEl.style.display = 'block';
                positionTooltip(e, el);
            };
            el.onblur = () => tooltipEl.style.display = 'none';
        };
        
        setBar('bar25F', v25F, p["FY25 Forecasted Spend"], "FY25 Forecasted Spend");
        setBar('bar25A', v25A, p["FY25 Actual Spend"], "FY25 Actual Spend");
        setBar('bar26F', v26F, p["FY26 Forecasted Spend"], "FY26 Forecasted Spend");
        setBar('bar26Fund', v26Fund, p["FY26 Project Funding"], "FY26 Project Funding");
        setBar('bar26A', v26A, "$0", "FY26 Actual Spend");
    }
</script>

</body>
</html>