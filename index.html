<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maryland Project Dashboard - Raw Data Integration</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
  rel="stylesheet"
  href="https://cdn.maryland.gov/mdwds/latest/css/mdwds.min.css"
/>
    <style>
        :root {
            --bg-color: #ffffff;
            --card-bg: #f8f9fa; 
            --text-dark: #1a202c;
            --text-light: #718096;
            
            /* Project Colors */
            --col-procurement: #a0aec0; /* Gray */
            --col-implementation: #2c5282; /* Dark Blue */
            --col-om: #bee3f8; /* Light Blue */
            
            --col-forecast: #fbba00; /* Yellow */
            --col-actual: #2c5282; /* Dark Blue */
        }

        body {
            margin: 0;
            padding: 40px;
            background-color: #fff;
            color: var(--text-dark);
        }

        /* --- Selector --- */
        .selector-container {
            background: #dadadac7;
            padding: 10px 10px;
            margin-bottom: 40px;
            border-radius: 4px;
            z-index: 100;

        }
        select {
            font-size: 14px;
            outline: none;
            cursor: pointer;
            min-width: 200px;
            padding: 10px;
            /* font-weight: bold; */
        }

        /* --- Header Section --- */
        .header-section {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 60px;
            padding-bottom: 20px;
        }

        .header-left {
            max-width: 50%;
        }

        .proj-id {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-light);
            margin-bottom: 5px;
            text-transform: uppercase;
        }

        .proj-name {
            font-size: 36px;
            font-weight: 800;
            line-height: 1.1;
            color: var(--text-dark);
            margin: 0;
        }

        .header-right {
            display: flex;
            gap: 80px;
            margin-top: 10px; 
        }

        .header-metric h3 {
            font-size: 12px;
            font-weight: 700;
            color: var(--text-light);
            text-transform: uppercase;
            margin: 0 0 5px 0;
            letter-spacing: 0.5px;
        }

        .header-metric p {
            font-size: 18px;
            font-weight: 700;
            margin: 0;
            color: var(--text-dark);
        }

        /* --- Main Grid Layout --- */
        .main-grid {
            display: grid;
            grid-template-columns: 300px 1fr; /* Left Summary, Right Visuals */
            gap: 60px;
        }

        /* Left Column: Summary */
        .summary-col h3 {
            font-size: 12px;
            font-weight: 700;
            color: var(--text-light);
            text-transform: uppercase;
            margin: 0 0 15px 0;
            letter-spacing: 0.5px;
        }

        .summary-text {
            font-size: 16px;
            line-height: 1.6;
            color: #2d3748;
            margin-bottom: 30px;
        }

        .summary-note {
            font-style: italic;
            color: var(--text-light);
            font-size: 14px;
            border-top: 1px solid #e2e8f0;
            padding-top: 15px;
        }

        /* Right Column: Visual Cards */
        .visuals-col {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .card {
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: 4px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 700;
            margin: 0 0 30px 0;
            color: var(--text-dark);
        }

        /* --- Timeline Card --- */
        .gantt-container {
            margin-bottom: 40px;
        }

        .timeline-years {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--text-light);
            margin-bottom: 10px;
            padding: 0 2%; 
        }

        .timeline-track-wrapper {
            position: relative;
            height: 50px;
        }
        
        .grid-lines {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            display: flex;
            justify-content: space-between;
            pointer-events: none;
            z-index: 0;
            padding: 0 2%;
        }
        .grid-line {
            width: 1px;
            height: 100%;
            border-left: 1px dashed #cbd5e0;
        }

        .timeline-track {
            position: relative;
            height: 100%;
            width: 100%;
            z-index: 1;
            display: flex;
            align-items: center;
        }

        .phase-bar {
            height: 40px; 
            position: absolute;
            top: 5px;
        }

        .timeline-legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #4a5568;
        }
        .legend-box {
            width: 16px;
            height: 16px;
            border-radius: 2px;
        }

        /* Timeline Metrics (Bottom of card) */
        .timeline-metrics {
            display: flex;
            justify-content: space-around;
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
        }

        .t-metric-val {
            font-size: 24px;
            font-weight: 700;
            display: block;
            margin-bottom: 5px;
        }
        .t-metric-lbl {
            font-size: 14px;
            font-weight: 700;
            color: var(--text-light);
        }

        /* --- Finance Card --- */
        .finance-layout {
            display: grid;
            grid-template-columns: 200px 1fr;
            gap: 40px;
            align-items: center;
        }

        .eac-container {
            text-align: center;
        }
        .eac-val {
            font-size: 28px;
            font-weight: 800;
            color: var(--text-dark);
            margin-bottom: 5px;
        }
        .eac-lbl {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-light);
            line-height: 1.3;
        }

        .chart-container {
            height: 180px;
            position: relative;
            width: 100%;
        }

        .chart-legend-custom {
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 10px;
            margin-left: 20px;
        }
    </style>
</head>
<body style="display:none" id="protected-page">

<script>
    (function() {
        // 2. Set your password here
        var password = "ThisIsNotRealData";
        
        // 3. Prompt the user for the password
        var user_input = prompt("Please enter the password to view this page:");

        // 4. Check if the password is correct
        if (user_input === password) {
            // If correct, show the page content
            document.getElementById('protected-page').style.display = 'block';
        } else {
            // If incorrect, show an error and reload (or redirect)
            alert("Incorrect password. Access denied.");
            window.location.reload(); // Reloads to ask again
            // Alternatively, redirect them away:
            // window.location.href = "https://google.com";
        }
    })();
</script>

    <div class="selector-container">
        <select id="projectSelect" onchange="renderProject(this.value)"></select>
    </div>

    <div class="header-section">
        <div class="header-left">
            <div class="proj-id" id="headId">-</div>
            <h1 class="proj-name" id="headName">-</h1>
        </div>
        <div class="header-right">
            <div class="header-metric">
                <h3>Accountable Agency</h3>
                <p id="headAgency">-</p>
            </div>
            <div class="header-metric">
                <h3>Project Phase</h3>
                <p id="headPhase">-</p>
            </div>
        </div>
    </div>

    <div class="main-grid">
        
        <div class="summary-col">
            <h3>Project Summary</h3>
            <div class="summary-text" id="projSummary">
                Loading...
            </div>
            <div class="summary-note">
                Note: This is a summary, contact accountable agency for detailed information.
            </div>
        </div>

        <div class="visuals-col">

            <div class="card">
                <h2 class="card-title">Current schedule</h2>
                
                <div class="gantt-container">
                    <div class="timeline-years">
                        <span>2016</span><span>2018</span><span>2020</span><span>2022</span><span>2024</span><span>2026</span><span>2028</span><span>2030</span>
                    </div>
                    
                    <div class="timeline-track-wrapper">
                        <div class="grid-lines">
                            <div class="grid-line"></div><div class="grid-line"></div><div class="grid-line"></div>
                            <div class="grid-line"></div><div class="grid-line"></div><div class="grid-line"></div>
                            <div class="grid-line"></div><div class="grid-line"></div>
                        </div>
                        <div class="timeline-track" id="timelineTrack">
                            </div>
                    </div>

                    <div class="timeline-legend">
                        <div class="legend-item">
                            <div class="legend-box" style="background:var(--col-procurement)"></div> Procurement
                        </div>
                        <div class="legend-item">
                            <div class="legend-box" style="background:var(--col-implementation)"></div> Implementation
                        </div>
                        <div class="legend-item">
                            <div class="legend-box" style="background:var(--col-om)"></div> Operations & Maintenance
                        </div>
                    </div>
                </div>

                <div class="timeline-metrics">
                    <div>
                        <span class="t-metric-val" id="metricLength">-</span>
                        <span class="t-metric-lbl">Estimated Project Length</span>
                    </div>
                    <div>
                        <span class="t-metric-val" id="metricRemaining">-</span>
                        <span class="t-metric-lbl">Estimated Time Remaining</span>
                    </div>
                    <div>
                        <span class="t-metric-val" id="metricEndYear">-</span>
                        <span class="t-metric-lbl">Estimated End Year</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">Amount Spent</h2>
                <div class="finance-layout">
                    <div class="eac-container">
                        <div class="eac-val" id="eacValue">-</div>
                        <div class="eac-lbl">Project<br>Estimate-at-<br>Completion</div>
                    </div>
                    
                    <div style="display:flex; align-items:center; width:100%;">
                        <div class="chart-container">
                            <canvas id="financeChart"></canvas>
                        </div>
                        <div class="chart-legend-custom">
                            <div class="legend-item">
                                <div class="legend-box" style="background:var(--col-forecast)"></div> Forecasted Spend
                            </div>
                            <div class="legend-item">
                                <div class="legend-box" style="background:var(--col-actual)"></div> Actual Spend
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

<script>
    // --- RAW JSON DATA ---
    const projectsData = [
    {
        "MITDP ID": "DBM-23-CBIS",
        "Name": "Capital Budgeting Information System (CBIS) replacement",
        "Agency": "Department of Budget and Management",
        "Phase": "O&M",
        "Project Length": "3 - 5 years",
        "Project Len Min": 3,
        "Project Length Max": 5,
        "Start Year": 2022,
        "End Year": 2027,
        "Project Time Remaining": "0 to 1 years",
        "Procurement Start - Current": "7/1/2022",
        "Procurement End - Current": "5/1/2024",
        "Implementation Start - Current": "5/2/2024",
        "Implementation End - Current": "12/31/2025",
        "O&M Start - Current": "1/1/2026",
        "O&M End - Current": "3/31/2027",
        "EAC": "$0M - $10M",
        "FY25 Forecasted Spend": "$1,639,972.54",
        "FY25 Actual Spend": "$1,627,244",
        "FY26 Project Funding": "$0",
        "FY26 Forecasted Spend": "$1,612,821.83",
        "Project Summary": "This project, an extension of the State’s Budget Analysis and Reporting System (BARS), is focused on modernizing the management of capital projects and programs. It will replace the existing CBIS, eliminate manual processes, and introduce advanced capabilities such as facility planning and geospatial integration. The new solution will be fully integrated with BARS and the Financial Management Information System (FMIS) to ensure consistency across budgeting and accounting processes, providing a more efficient, transparent, and secure approach to managing the State’s capital budgeting activities."
    },
    {
        "MITDP ID": "COMP-22-PSM",
        "Name": "CPB Payroll System Modernization (PSM)",
        "Agency": "Comptroller of Maryland",
        "Phase": "Implementation",
        "Project Length": "5 - 7 years",
        "Project Len Min": 5,
        "Project Length Max": 7,
        "Start Year": 2021,
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start - Current": "7/1/2021",
        "Procurement End - Current": "8/30/2024",
        "Implementation Start - Current": "8/31/2024",
        "Implementation End - Current": "7/1/2026",
        "O&M Start - Current": "7/2/2026",
        "O&M End - Current": "9/30/2027",
        "EAC": "$40M - $50M",
        "FY25 Forecasted Spend": "$17,780,793.58",
        "FY25 Actual Spend": "$16,593,911",
        "FY26 Project Funding": "$19,007,550",
        "FY26 Forecasted Spend": "$20,766,900.41",
        "Project Summary": "A statewide project by the Central Payroll Bureau to replace the legacy mainframe payroll system with a modern, cloud-based Software as a Service (SaaS) solution. This transformation is designed to streamline and automate outdated payroll processes while introducing standardized industry best practices to strengthen efficiency, accuracy, and compliance. The new scalable system will serve over 100,000 employees across all branches of the State of Maryland, modernizing payroll operations and enhancing the user experience."
    },
    {
        "MITDP ID": "MDH-23-OPER",
        "Name": "OPER - Systems Integration and Modernization",
        "Agency": "Maryland Department of Health",
        "Phase": "Implementation",
        "Project Length": "4 - 6 years",
        "Project Len Min": 4,
        "Project Length Max": 6,
        "Start Year": 2022,
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start - Current": "10/3/2022",
        "Procurement End - Current": "9/30/2025",
        "Implementation Start - Current": "10/1/2025",
        "Implementation End - Current": "9/30/2026",
        "O&M Start - Current": "10/1/2026",
        "O&M End - Current": "12/31/2027",
        "EAC": "$0M - $10M",
        "FY25 Forecasted Spend": "$4,204.68",
        "FY25 Actual Spend": "$4,205",
        "FY26 Project Funding": "$2,356,598",
        "FY26 Forecasted Spend": "$2,295,120.48",
        "Project Summary": "A Maryland Department of Health (MDH) initiative to modernize licensing, compliance, and workforce regulatory functions led by the Office of Controlled Substances Administration. The project aims to enhance healthcare delivery and streamline regulatory oversight by replacing outdated manual processes with a unified, cloud-based system accessible to the public. Key benefits include strengthened data security, real-time reporting, disaster recovery, and improved efficiency and adaptability to statutory changes. It supports automated licensing and compliance for Controlled Dangerous Substances, as well as the recruitment, accreditation, and certification of Community Health Workers."
    },
    {
        "MITDP ID": "MDH-25-MMT_DASO",
        "Name": "MMT - Dental Administrative Services (DASO)",
        "Agency": "Maryland Department of Health",
        "Phase": "O&M",
        "Project Length": "8 - 10 years",
        "Project Len Min": 8,
        "Project Length Max": 10,
        "Start Year": 2018,
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start - Current": "7/1/2018",
        "Procurement End - Current": "2/3/2025",
        "Implementation Start - Current": "2/4/2025",
        "Implementation End - Current": "12/31/2025",
        "O&M Start - Current": "1/1/2026",
        "O&M End - Current": "3/31/2027",
        "EAC": "$30M - $40M",
        "FY25 Forecasted Spend": "$2,114,690.32",
        "FY25 Actual Spend": "$1,682,960",
        "FY26 Project Funding": "$17,339,778",
        "FY26 Forecasted Spend": "$7,221,271.78",
        "Project Summary": "A Maryland Department of Health (MDH) initiative under the Medicaid Enterprise Systems Modular Transformation (MMT) to improve access to dental care for Medicaid members and ensure prompt reimbursement for providers by establishing a new Dental Administrative Services Organization (DASO). The project's dual objectives are to increase annual utilization of preventive and restorative dental services by at least one percent each year, and to develop and operate a robust claims processing system that ensures accuracy and timeliness. The system is required to process electronic claims within 14 calendar days, enhancing the oral health outcomes of Medicaid members while modernizing and streamlining the administration of dental services."
    },
    {
        "MITDP ID": "MDL-22-LOCCS",
        "Name": "LABOR Omni-channel Contact Center System (LOCCS)",
        "Agency": "Department of Labor",
        "Phase": "Implementation",
        "Project Length": "5 - 7 years",
        "Project Len Min": 5,
        "Project Length Max": 7,
        "Start Year": 2021,
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start - Current": "7/1/2021",
        "Procurement End - Current": "12/14/2024",
        "Implementation Start - Current": "12/15/2024",
        "Implementation End - Current": "6/30/2026",
        "O&M Start - Current": "7/1/2026",
        "O&M End - Current": "6/30/2027",
        "EAC": "$10M - $20M",
        "FY25 Forecasted Spend": "$635,516.31",
        "FY25 Actual Spend": "$0",
        "FY26 Project Funding": "$7,009,198",
        "FY26 Forecasted Spend": "$1,653,489.29",
        "Project Summary": "A multi-phase initiative by the Maryland Department of Labor's Unemployment Insurance division to modernize and centralize contact center operations. It replaces the temporary, outsourced COVID-era call center with a State-managed, cloud-based Software as a Service (SaaS) solution. LOCCS provides omni-channel capabilities, including voice, chat, email, and self-service IVR. The solution is designed to improve customer service, streamline case handling, reduce duplicate data entry, and integrate with the existing BEACON and Salesforce platforms to deliver a modern, efficient, and resident-focused customer service model across unemployment insurance functions."
    },
    {
        "MITDP ID": "MHEC-23-FAMS",
        "Name": "New Unified Financial Aid System for Higher Education ( or MDCAPS 2.0)",
        "Agency": "Maryland Higher Education Commission",
        "Phase": "Implementation",
        "Project Length": "4 - 6 years",
        "Project Len Min": 4,
        "Project Length Max": 6,
        "Start Year": 2022,
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start - Current": "7/1/2022",
        "Procurement End - Current": "3/18/2025",
        "Implementation Start - Current": "3/25/2025",
        "Implementation End - Current": "9/18/2026",
        "O&M Start - Current": "9/21/2026",
        "O&M End - Current": "12/18/2027",
        "EAC": "$10M - $20M",
        "FY25 Forecasted Spend": "$743,327.58",
        "FY25 Actual Spend": "$731,972",
        "FY26 Project Funding": "$3,071,111",
        "FY26 Forecasted Spend": "$8,946,934.48",
        "Project Summary": "A statewide initiative by the Maryland Higher Education Commission (MHEC) to transform student access to financial aid across 29 State programs. The project implements a new web-based application that consolidates access to all scholarships, offering features like multilingual support, mobile accessibility, and electronic signatures. The system will streamline administrative functions, including processing applications, managing awards, and verifying eligibility. It aims to improve the student experience, enhance communication with real-time updates, and strengthen data-driven decision making through detailed reports and performance metrics."
    },
    {
        "MITDP ID": "SBE-24-NCRIS",
        "Name": "Campaign Reporting Information System (CRIS)",
        "Agency": "Maryland State Board of Elections",
        "Phase": "O&M",
        "Project Length": "3 - 5 years",
        "Project Len Min": 3,
        "Project Length Max": 5,
        "Start Year": 2023,
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start - Current": "7/4/2023",
        "Procurement End - Current": "1/29/2025",
        "Implementation Start - Current": "1/30/2025",
        "Implementation End - Current": "11/30/2025",
        "O&M Start - Current": "12/1/2025",
        "O&M End - Current": "12/31/2026",
        "EAC": "$0M - $10M",
        "FY25 Forecasted Spend": "$924,021.94",
        "FY25 Actual Spend": "$1,033,093",
        "FY26 Project Funding": "$521,626",
        "FY26 Forecasted Spend": "$2,601,286.23",
        "Project Summary": "The Maryland State Board of Elections (SBE) is procuring a new Campaign Reporting Information System (NCRIS) prior to the 2026 election cycle to fully manage the State’s campaign finance system. The system enables contributors and committees to self-register, document all financial activity (contributions, expenditures, loans), and electronically file reports. The SBE uses the system (currently MDCRIS) to oversee filing cycles, approve registrations, run audits on delinquent committees, and fine them. It also includes the Business Contribution Disclosure System (BCDS) module for required electronic filing of contribution disclosures by persons doing business with the State."
    },
    {
        "MITDP ID": "STO-18-FSM",
        "Name": "Financial Systems Modernization",
        "Agency": "State Treasurer's Office",
        "Phase": "Implementation",
        "Project Length": "9 - 11 years",
        "Project Len Min": 9,
        "Project Length Max": 11,
        "Start Year": 2017,
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start - Current": "7/1/2017",
        "Procurement End - Current": "9/1/2018",
        "Implementation Start - Current": "9/2/2018",
        "Implementation End - Current": "6/30/2026",
        "O&M Start - Current": "7/1/2026",
        "O&M End - Current": "6/30/2027",
        "EAC": "$30M - $40M",
        "FY25 Forecasted Spend": "$5,560,323.28",
        "FY25 Actual Spend": "$6,398,733",
        "FY26 Project Funding": "$6,199,456",
        "FY26 Forecasted Spend": "$6,539,054.07",
        "Project Summary": "A strategic initiative to transition the State Treasurer’s Office (STO) from its aging IBM AS400/i5 Treasury and Insurance Management System to a modern, cloud-based Microsoft enterprise resource planning (ERP) financial and insurance management solution. This modernization is essential to ensuring the continuity and enhancement of the Treasurer’s Office mission-critical functions, which include funds disbursement, daily cash flow management, reconciliation, ACH/wire transfers, investment of State funds, and claims management. The transition is imperative due to IBM’s end-of-service date for the legacy platform. The FSM project will deliver a secure, reliable, and scalable platform that strengthens financial management and improves efficiency."
    },
    {
        "MITDP ID": "DGS-18-EMM",
        "Name": "Maryland Marketplace (eMMA) eProcurement Solution",
        "Agency": "Department of General Services",
        "Phase": "Implementation",
        "Project Length": "10 - 12 years",
        "Project Len Min": 10,
        "Project Length Max": 12,
        "Start Year": 2017,
        "End Year": 2029,
        "Project Time Remaining": "1 to 3 years",
        "Procurement Start - Current": "7/1/2017",
        "Procurement End - Current": "2/1/2019",
        "Implementation Start - Current": "1/7/2020",
        "Implementation End - Current": "12/31/2027",
        "O&M Start - Current": "1/1/2028",
        "O&M End - Current": "12/31/2028",
        "EAC": "$70M - $80M",
        "FY25 Forecasted Spend": "$3,239,585.29",
        "FY25 Actual Spend": "$2,771,967",
        "FY26 Project Funding": "$5,353,724",
        "FY26 Forecasted Spend": "$12,557,419.76",
        "Project Summary": "This project is modernizing the State of Maryland’s enterprise procurement platform to standardize how State agencies manage solicitations, contracts, and vendor interactions. Following an internal assessment and an Executive Order, the eMMA platform is enhancing its capabilities with strategic sourcing, catalog management, advanced reporting, and improved compliance for small and minority-owned businesses. The goal is to unify procurement practices, increase accountability and transparency, and drive efficiency, equity, and innovation in Maryland’s procurement operations."
    },
    {
        "MITDP ID": "DBM-25-FLEET",
        "Name": "Fleet Management System Replacement",
        "Agency": "Department of Budget and Management",
        "Phase": "Implementation",
        "Project Length": "6 - 8 years",
        "Project Len Min": 6,
        "Project Length Max": 8,
        "Start Year": 2021,
        "End Year": 2029,
        "Project Time Remaining": "1 to 3 years",
        "Procurement Start - Current": "1/7/2021",
        "Procurement End - Current": "6/30/2025",
        "Implementation Start - Current": "7/1/2025",
        "Implementation End - Current": "3/31/2026",
        "O&M Start - Current": "4/1/2026",
        "O&M End - Current": "6/29/2027",
        "EAC": "$0M - $10M",
        "FY25 Forecasted Spend": "$200,000.00",
        "FY25 Actual Spend": "$0",
        "FY26 Project Funding": "$1,250,000",
        "FY26 Forecasted Spend": "$1,420,000.00",
        "Project Summary": "A statewide initiative by the Department of Budget and Management (DBM) to replace the legacy WebFleetMaster system with a fully functional and customizable software solution. The new system will modernize fleet operations by tracking vehicles, repairs, usage, drivers, and telematics data, and consolidating manual processes. It aims to provide enhanced reporting and dashboard capabilities and will interface with critical platforms including FMIS and eMMA. The goal is to deliver a modern, secure, and integrated fleet management solution that supports fiscal accountability."
    },
    {
        "MITDP ID": "DNR-21-ONESTOP",
        "Name": "DNR Modernization and OneStop Integration Project",
        "Agency": "Department of Natural Resources",
        "Phase": "Implementation",
        "Project Length": "8 - 10 years",
        "Project Len Min": 8,
        "Project Length Max": 10,
        "Start Year": 2019,
        "End Year": 2029,
        "Project Time Remaining": "1 to 3 years",
        "Procurement Start - Current": "10/1/2019",
        "Procurement End - Current": "10/1/2023",
        "Implementation Start - Current": "10/1/2023",
        "Implementation End - Current": "3/1/2026",
        "O&M Start - Current": "3/1/2026",
        "O&M End - Current": "6/1/2027",
        "EAC": "$20M - $30M",
        "FY25 Forecasted Spend": "$1,388,000.00",
        "FY25 Actual Spend": "$166,800",
        "FY26 Project Funding": "$0",
        "FY26 Forecasted Spend": "$4,405,550.00",
        "Project Summary": "A statewide initiative by the Department of Natural Resources (DNR) to replace the COMPASS system with a modern, web-based Commercial Off-the-Shelf (COTS) platform for comprehensive licensing and permitting services. The solution will provide a central point of access for all 134 licenses and permits, with features including online payment processing, workflow automation, and an Open Application Programming Interface (API) for integration. The project also incorporates Geographic Information System (GIS) enhancements, aiming to improve the customer experience and ensure a scalable system."
    },
    {
        "MITDP ID": "MDE-25-PORTAL",
        "Name": "MDE Portal Project",
        "Agency": "Department of the Environment",
        "Phase": "Implementation",
        "Project Length": "3 - 5 years",
        "Project Len Min": 3,
        "Project Length Max": 5,
        "Start Year": 2024,
        "End Year": 2029,
        "Project Time Remaining": "1 to 3 years",
        "Procurement Start - Current": "7/1/2024",
        "Procurement End - Current": "3/14/2025",
        "Implementation Start - Current": "3/17/2025",
        "Implementation End - Current": "3/1/2027",
        "O&M Start - Current": "3/2/2027",
        "O&M End - Current": "5/31/2028",
        "EAC": "$0M - $10M",
        "FY25 Forecasted Spend": "$287,957.32",
        "FY25 Actual Spend": "$275,078",
        "FY26 Project Funding": "$2,000,000",
        "FY26 Forecasted Spend": "$1,241,270.64",
        "Project Summary": "A modernization initiative by the Maryland Department of the Environment (MDE) to create a centralized online portal and payment system for managing permitting and licensing applications, replacing primarily paper-based processes. The portal will streamline public access to approximately 460 forms by offering structured informational pages, real-time status tracking, and integrated payment functionality. Key features include a comprehensive payment portal and support for specialized forms like the National Pollutant Discharge Elimination System (NPDES) submissions. The goal is to enhance customer service and provide a secure, user-friendly, and fully digital solution for residents and businesses needing timely and accurate environmental permitting."
    },
    {
        "MITDP ID": "MDE-25-WELLS",
        "Name": "Wells and Septic Portal",
        "Agency": "Department of the Environment",
        "Phase": "Implementation",
        "Project Length": "3 - 5 years",
        "Project Len Min": 3,
        "Project Length Max": 5,
        "Start Year": 2024,
        "End Year": 2029,
        "Project Time Remaining": "1 to 3 years",
        "Procurement Start - Current": "7/1/2024",
        "Procurement End - Current": "8/31/2025",
        "Implementation Start - Current": "9/1/2025",
        "Implementation End - Current": "8/31/2027",
        "O&M Start - Current": "9/1/2027",
        "O&M End - Current": "11/30/2028",
        "EAC": "$0M - $10M",
        "FY25 Forecasted Spend": "$200,000.00",
        "FY25 Actual Spend": "$0",
        "FY26 Project Funding": "$1,050,000",
        "FY26 Forecasted Spend": "$864,462.96",
        "Project Summary": "An MDE modernization initiative to streamline the management of on-site sewage disposal systems and well installation permits. It will deliver a comprehensive online platform enabling applicants to submit and pay for permit requests and providing automated application management tools. By digitizing the process, the portal will offer contractors and stakeholders real-time visibility into status updates, reducing delays and improving transparency. The initiative also includes informational web pages and training materials to support public awareness and effective user adoption. This effort is designed to meet all regulatory and operational requirements while enhancing efficiency, accessibility, and accountability in managing Maryland’s well and septic permitting processes."
    },
    {
        "MITDP ID": "MDH-16-EHR",
        "Name": "Statewide Electronic Health Records (EHR) system",
        "Agency": "Maryland Department of Health",
        "Phase": "Implementation",
        "Project Length": "6 - 8 years",
        "Project Len Min": 6,
        "Project Length Max": 8,
        "Start Year": 2021,
        "End Year": 2029,
        "Project Time Remaining": "1 to 3 years",
        "Procurement Start - Current": "8/6/2021",
        "Procurement End - Current": "10/1/2023",
        "Implementation Start - Current": "10/2/2023",
        "Implementation End - Current": "12/31/2026",
        "O&M Start - Current": "1/1/2027",
        "O&M End - Current": "3/31/2028",
        "EAC": "$30M - $40M",
        "FY25 Forecasted Spend": "$6,276,198.99",
        "FY25 Actual Spend": "$5,852,884",
        "FY26 Project Funding": "$1,262,665",
        "FY26 Forecasted Spend": "$8,874,155.28",
        "Project Summary": "A Maryland Department of Health (MDH) initiative to replace the legacy Health Management Information System with a commercially available, cloud-based Software as a Service (SaaS) solution. The system will support health and revenue-cycle operations across eleven State-run treatment centers, including eight behavioral health facilities and three hospitals. It will streamline patient admission, discharge, and transfer, and manage functions like revenue cycle, pharmacy, laboratory, and clinical documentation on a standardized platform. Adopting a commercial SaaS product ensures scalability and sustainability, with the goal of enhancing reporting, improving operational efficiency, and ultimately elevating the quality of patient care."
    },
    {
        "MITDP ID": "MDH-19-BON",
        "Name": "Enterprise Licensing and Regulatory Management Solution (LRMS)",
        "Agency": "Maryland Department of Health",
        "Phase": "Implementation",
        "Project Length": "4 - 6 years",
        "Project Len Min": 4,
        "Project Length Max": 6,
        "Start Year": 2023,
        "End Year": 2029,
        "Project Time Remaining": "1 to 3 years",
        "Procurement Start - Current": "7/3/2023",
        "Procurement End - Current": "8/29/2025",
        "Implementation Start - Current": "8/30/2025",
        "Implementation End - Current": "9/30/2026",
        "O&M Start - Current": "10/1/2026",
        "O&M End - Current": "12/30/2027",
        "EAC": "$10M - $20M",
        "FY25 Forecasted Spend": "$193,832.32",
        "FY25 Actual Spend": "$226,672",
        "FY26 Project Funding": "$1,714,229",
        "FY26 Forecasted Spend": "$3,628,332.95",
        "Project Summary": "An MDH initiative to enhance the ability of the Maryland Board of Nursing (MBON) to manage health profession services and regulatory functions. It establishes a modern, scalable enterprise platform that will first support the MBON and then be extended to the State’s twenty-two other health profession boards. The solution strengthens public health and safety by enabling more effective credentialing, permitting, licensing, examination, inspection, and discipline of healthcare providers and facilities. By providing a consistent and scalable system, the project advances Maryland’s ability to regulate health professions with greater efficiency, accountability, and transparency."
    }
];

    let myChart = null;

    // Helper: Parse currency strings (e.g. "$1,639,972.54" -> 1639972.54)
    function parseCurrency(str) {
        if (!str) return 0;
        // remove '$' and ',' then parse
        return parseFloat(str.toString().replace(/[$,]/g, '')) || 0;
    }

    // Initialize logic
    window.onload = function() {
        populateSelector();
        initChart();
        renderProject(1); // Default to Payroll to show good data
    };

    function populateSelector() {
        const sel = document.getElementById('projectSelect');
        projectsData.forEach((p, idx) => {
            const opt = document.createElement('option');
            opt.value = idx;
            opt.text = p.Name;
            sel.appendChild(opt);
        });
    }

    function initChart() {
        const ctx = document.getElementById('financeChart').getContext('2d');
        myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['FY25 Forecast', 'FY25 Actual'],
                datasets: [{
                    data: [0, 0],
                    backgroundColor: ['#fbba00', '#2c5282'], // Yellow, Blue
                    borderRadius: 2,
                    barPercentage: 0.6,
                    categoryPercentage: 0.8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                let val = context.parsed.y;
                                if(val >= 1000000) return '$' + (val/1000000).toFixed(2) + 'M';
                                return '$' + val.toLocaleString();
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: '#e2e8f0',
                            borderDash: [5, 5]
                        },
                        ticks: {
                            callback: function(val) {
                                return '$' + (val/1000000).toFixed(0) + 'M';
                            },
                            font: { size: 10 }
                        },
                        border: { display: false }
                    },
                    x: {
                        grid: { display: false },
                        ticks: { display: false }, // Hiding X labels as we have legend
                        border: { display: false }
                    }
                }
            }
        });
    }

    function renderProject(index) {
        const p = projectsData[index];

        // 1. Header
        document.getElementById('headId').innerText = p["MITDP ID"];
        document.getElementById('headName').innerText = p.Name;
        document.getElementById('headAgency').innerText = p.Agency;
        document.getElementById('headPhase').innerText = p.Phase;

        // 2. Summary
        document.getElementById('projSummary').innerText = p["Project Summary"];

        // 3. Schedule Metrics
        document.getElementById('metricLength').innerText = p["Project Length"];
        document.getElementById('metricRemaining').innerText = p["Project Time Remaining"];
        document.getElementById('metricEndYear').innerText = p["End Year"];

        // 4. Draw Gantt
        drawGantt(p);

        // 5. Finance
        document.getElementById('eacValue').innerText = p.EAC;
        
        // Use helper to parse the strings
        const forecast = parseCurrency(p["FY25 Forecasted Spend"]);
        const actual = parseCurrency(p["FY25 Actual Spend"]);

        myChart.data.datasets[0].data = [forecast, actual];
        myChart.update();
    }

    function drawGantt(p) {
        const track = document.getElementById('timelineTrack');
        track.innerHTML = '';

        // Fixed range: 2016 to 2030 (14 years)
        const minYear = 2016;
        const maxYear = 2030;
        const span = maxYear - minYear;

        // Access the specific "- Current" keys
        const phases = [
            { s: p["Procurement Start - Current"], e: p["Procurement End - Current"], c: 'var(--col-procurement)' },
            { s: p["Implementation Start - Current"], e: p["Implementation End - Current"], c: 'var(--col-implementation)' },
            { s: p["O&M Start - Current"], e: p["O&M End - Current"], c: 'var(--col-om)' }
        ];

        phases.forEach(ph => {
            if(!ph.s || !ph.e) return;
            const startD = new Date(ph.s);
            const endD = new Date(ph.e);
            
            const startVal = startD.getFullYear() + startD.getMonth()/12;
            const endVal = endD.getFullYear() + endD.getMonth()/12;

            let leftPct = ((startVal - minYear) / span) * 100;
            let widthPct = ((endVal - startVal) / span) * 100;

            // Bounds check visual
            if(leftPct < 0) { widthPct += leftPct; leftPct = 0; }
            if(widthPct < 0) return;

            const bar = document.createElement('div');
            bar.className = 'phase-bar';
            bar.style.left = leftPct + '%';
            bar.style.width = widthPct + '%';
            bar.style.backgroundColor = ph.c;
            track.appendChild(bar);
        });
    }

</script>
</body>
</html>