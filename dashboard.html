<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Portfolio Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-blue: #2c5282;
            --highlight-yellow: #f6ad55;
            --bg-gray: #f7fafc;
            --text-dark: #2d3748;
            --text-light: #718096;
            --procurement-color: #a0aec0;
            --implementation-color: #4299e1;
            --om-color: #ed8936;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--bg-gray);
            color: var(--text-dark);
        }

        /* Top Bar & Selector */
        .top-bar {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        select {
            padding: 10px;
            font-size: 16px;
            border: 1px solid #cbd5e0;
            border-radius: 4px;
            flex-grow: 1;
            max-width: 600px;
        }

        /* Dashboard Grid */
        .dashboard-container {
            display: grid;
            grid-template-columns: 250px 1fr;
            grid-template-rows: auto auto auto;
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Card Styling */
        .card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        /* EAC Section (Left Top) */
        .eac-card {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-start;
            border-left: 5px solid var(--primary-blue);
        }

        .eac-value {
            font-size: 28px;
            font-weight: bold;
            color: var(--text-dark);
        }

        .label {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-light);
            margin-top: 5px;
        }

        /* Chart Section (Right Top) */
        .chart-card {
            height: 250px;
            position: relative;
        }
        
        .chart-container {
            position: relative;
            height: 100%;
            width: 100%;
        }

        /* Details Section (Full Width Middle) */
        .details-grid {
            grid-column: 1 / -1;
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
        }

        .meta-data h3 {
            margin: 0 0 5px 0;
            font-size: 14px;
            color: var(--text-light);
            text-transform: uppercase;
        }

        .meta-data p {
            margin: 0 0 15px 0;
            font-size: 18px;
            font-weight: 600;
        }

        .project-summary {
            font-size: 14px;
            line-height: 1.6;
            color: #4a5568;
        }

        /* Timeline Section (Bottom) */
        .timeline-card {
            grid-column: 1 / -1;
        }

        .timeline-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 10px;
        }

        .timeline-metric {
            text-align: center;
        }

        .timeline-metric .value {
            display: block;
            font-size: 18px;
            font-weight: bold;
            color: var(--primary-blue);
        }

        /* Timeline Visualization */
        .gantt-container {
            position: relative;
            margin-top: 30px;
            padding-bottom: 20px;
        }

        .timeline-years {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 12px;
            color: var(--text-light);
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 5px;
        }

        .timeline-track {
            position: relative;
            height: 40px;
            background: #edf2f7;
            border-radius: 20px;
            overflow: hidden;
        }

        .phase-bar {
            position: absolute;
            height: 100%;
            top: 0;
            color: white;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            transition: width 0.5s ease, left 0.5s ease;
        }

        .legend {
            display: flex;
            gap: 15px;
            margin-top: 15px;
            font-size: 12px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

    </style>
</head>
<body>

    <div class="top-bar">
        <label for="projectSelect"><strong>Select Project:</strong></label>
        <select id="projectSelect" onchange="loadProject(this.value)">
            </select>
    </div>

    <div class="dashboard-container">
        
        <div class="card eac-card">
            <div class="eac-value" id="eacDisplay">$0M - $0M</div>
            <div class="label">Project Estimate-at-Completion</div>
        </div>

        <div class="card chart-card">
            <h3 style="margin: 0 0 10px 0; font-size: 16px;">Amount Spent (FY25)</h3>
            <div class="chart-container">
                <canvas id="spendChart"></canvas>
            </div>
        </div>

        <div class="card details-grid">
            <div class="meta-data">
                <h3>Accountable Agency</h3>
                <p id="agencyDisplay">-</p>
                
                <h3>Project Phase</h3>
                <p id="phaseDisplay">-</p>

                <h3>MITDP ID</h3>
                <p id="idDisplay" style="font-size: 14px; font-weight: normal;">-</p>
            </div>
            <div>
                <h3>Project Summary</h3>
                <div class="project-summary" id="summaryDisplay">
                    Select a project to view details.
                </div>
            </div>
        </div>

        <div class="card timeline-card">
            <div class="timeline-header">
                <div class="timeline-metric">
                    <span class="value" id="lengthDisplay">-</span>
                    <span class="label">Est. Length</span>
                </div>
                <div class="timeline-metric">
                    <span class="value" id="remainingDisplay">-</span>
                    <span class="label">Time Remaining</span>
                </div>
                <div class="timeline-metric">
                    <span class="value" id="endYearDisplay">-</span>
                    <span class="label">Est. End Year</span>
                </div>
            </div>

            <div class="gantt-container">
                <div class="timeline-years">
                    <span>2016</span><span>2018</span><span>2020</span><span>2022</span><span>2024</span><span>2026</span><span>2028</span><span>2030</span>
                </div>
                
                <div class="timeline-track" id="timelineTrack">
                    </div>

                <div class="legend">
                    <div class="legend-item"><div class="dot" style="background:var(--procurement-color)"></div> Procurement</div>
                    <div class="legend-item"><div class="dot" style="background:var(--implementation-color)"></div> Implementation</div>
                    <div class="legend-item"><div class="dot" style="background:var(--om-color)"></div> Operations & Maint.</div>
                </div>
            </div>
        </div>

    </div>

<script>
    // --- Data Source ---
    const projectsData = [
    {
        "MITDP ID": "DBM-23-CBIS",
        "Name": "Capital Budgeting Information System (CBIS) replacement",
        "Agency": "Department of Budget and Management",
        "Phase": "O&M",
        "Project Length": "3 - 5 years",
        "End Year": 2027,
        "Project Time Remaining": "0 to 1 years",
        "Procurement Start": "7/1/2022", "Procurement End": "5/1/2024",
        "Implementation Start": "5/2/2024", "Implementation End": "12/31/2025",
        "O&M Start": "1/1/2026", "O&M End": "3/31/2027",
        "EAC": "$0M - $10M",
        "FY25 Forecasted Spend": 1639972.54,
        "FY25 Actual Spend": 1627244,
        "Project Summary": "This project, an extension of the State’s Budget Analysis and Reporting System (BARS), is focused on modernizing the management of capital projects and programs. It will replace the existing CBIS, eliminate manual processes, and introduce advanced capabilities such as facility planning and geospatial integration."
    },
    {
        "MITDP ID": "COMP-22-PSM",
        "Name": "CPB Payroll System Modernization (PSM)",
        "Agency": "Comptroller of Maryland",
        "Phase": "Implementation",
        "Project Length": "5 - 7 years",
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start": "7/1/2021", "Procurement End": "8/30/2024",
        "Implementation Start": "8/31/2024", "Implementation End": "7/1/2026",
        "O&M Start": "7/2/2026", "O&M End": "9/30/2027",
        "EAC": "$40M - $50M",
        "FY25 Forecasted Spend": 17780793.58,
        "FY25 Actual Spend": 16593911,
        "Project Summary": "A statewide project by the Central Payroll Bureau to replace the legacy mainframe payroll system with a modern, cloud-based Software as a Service (SaaS) solution. This transformation is designed to streamline and automate outdated payroll processes while introducing standardized industry best practices."
    },
    {
        "MITDP ID": "MDH-23-OPER",
        "Name": "OPER - Systems Integration and Modernization",
        "Agency": "Maryland Department of Health",
        "Phase": "Implementation",
        "Project Length": "4 - 6 years",
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start": "10/3/2022", "Procurement End": "9/30/2025",
        "Implementation Start": "10/1/2025", "Implementation End": "9/30/2026",
        "O&M Start": "10/1/2026", "O&M End": "12/31/2027",
        "EAC": "$0M - $10M",
        "FY25 Forecasted Spend": 4204.68,
        "FY25 Actual Spend": 4205,
        "Project Summary": "A Maryland Department of Health (MDH) initiative to modernize licensing, compliance, and workforce regulatory functions led by the Office of Controlled Substances Administration. The project aims to enhance healthcare delivery and streamline regulatory oversight by replacing outdated manual processes."
    },
    {
        "MITDP ID": "MDH-25-MMT_DASO",
        "Name": "MMT - Dental Administrative Services (DASO)",
        "Agency": "Maryland Department of Health",
        "Phase": "O&M",
        "Project Length": "8 - 10 years",
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start": "7/1/2018", "Procurement End": "2/3/2025",
        "Implementation Start": "2/4/2025", "Implementation End": "12/31/2025",
        "O&M Start": "1/1/2026", "O&M End": "3/31/2027",
        "EAC": "$30M - $40M",
        "FY25 Forecasted Spend": 2114690.32,
        "FY25 Actual Spend": 1682960,
        "Project Summary": "A Maryland Department of Health (MDH) initiative under the Medicaid Enterprise Systems Modular Transformation (MMT) to improve access to dental care for Medicaid members and ensure prompt reimbursement for providers by establishing a new Dental Administrative Services Organization (DASO)."
    },
    {
        "MITDP ID": "MDL-22-LOCCS",
        "Name": "LABOR Omni-channel Contact Center System (LOCCS)",
        "Agency": "Department of Labor",
        "Phase": "Implementation",
        "Project Length": "5 - 7 years",
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start": "7/1/2021", "Procurement End": "12/14/2024",
        "Implementation Start": "12/15/2024", "Implementation End": "6/30/2026",
        "O&M Start": "7/1/2026", "O&M End": "6/30/2027",
        "EAC": "$10M - $20M",
        "FY25 Forecasted Spend": 635516.31,
        "FY25 Actual Spend": 0,
        "Project Summary": "A multi-phase initiative by the Maryland Department of Labor's Unemployment Insurance division to modernize and centralize contact center operations. It replaces the temporary, outsourced COVID-era call center with a State-managed, cloud-based Software as a Service (SaaS) solution."
    },
    {
        "MITDP ID": "MHEC-23-FAMS",
        "Name": "New Unified Financial Aid System for Higher Education",
        "Agency": "Maryland Higher Education Commission",
        "Phase": "Implementation",
        "Project Length": "4 - 6 years",
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start": "7/1/2022", "Procurement End": "3/18/2025",
        "Implementation Start": "3/25/2025", "Implementation End": "9/18/2026",
        "O&M Start": "9/21/2026", "O&M End": "12/18/2027",
        "EAC": "$10M - $20M",
        "FY25 Forecasted Spend": 743327.58,
        "FY25 Actual Spend": 731972,
        "Project Summary": "A statewide initiative by the Maryland Higher Education Commission (MHEC) to transform student access to financial aid across 29 State programs. The project implements a new web-based application that consolidates access to all scholarships, offering features like multilingual support and mobile accessibility."
    },
    {
        "MITDP ID": "STO-18-FSM",
        "Name": "Financial Systems Modernization",
        "Agency": "State Treasurer's Office",
        "Phase": "Implementation",
        "Project Length": "9 - 11 years",
        "End Year": 2028,
        "Project Time Remaining": "0 to 2 years",
        "Procurement Start": "7/1/2017", "Procurement End": "9/1/2018",
        "Implementation Start": "9/2/2018", "Implementation End": "6/30/2026",
        "O&M Start": "7/1/2026", "O&M End": "6/30/2027",
        "EAC": "$30M - $40M",
        "FY25 Forecasted Spend": 5560323.28,
        "FY25 Actual Spend": 6398733,
        "Project Summary": "A strategic initiative to transition the State Treasurer’s Office (STO) from its aging IBM AS400/i5 Treasury and Insurance Management System to a modern, cloud-based Microsoft enterprise resource planning (ERP) financial and insurance management solution."
    },
    {
        "MITDP ID": "DGS-18-EMM",
        "Name": "Maryland Marketplace (eMMA) eProcurement Solution",
        "Agency": "Department of General Services",
        "Phase": "Implementation",
        "Project Length": "10 - 12 years",
        "End Year": 2029,
        "Project Time Remaining": "1 to 3 years",
        "Procurement Start": "7/1/2017", "Procurement End": "2/1/2019",
        "Implementation Start": "1/7/2020", "Implementation End": "12/31/2027",
        "O&M Start": "1/1/2028", "O&M End": "12/31/2028",
        "EAC": "$70M - $80M",
        "FY25 Forecasted Spend": 3239585.29,
        "FY25 Actual Spend": 2771967,
        "Project Summary": "This project is modernizing the State of Maryland’s enterprise procurement platform to standardize how State agencies manage solicitations, contracts, and vendor interactions. Following an internal assessment and an Executive Order, the eMMA platform is enhancing its capabilities."
    },
    {
        "MITDP ID": "DNR-21-ONESTOP",
        "Name": "DNR Modernization and OneStop Integration Project",
        "Agency": "Department of Natural Resources",
        "Phase": "Implementation",
        "Project Length": "8 - 10 years",
        "End Year": 2029,
        "Project Time Remaining": "1 to 3 years",
        "Procurement Start": "10/1/2019", "Procurement End": "10/1/2023",
        "Implementation Start": "10/1/2023", "Implementation End": "3/1/2026",
        "O&M Start": "3/1/2026", "O&M End": "6/1/2027",
        "EAC": "$20M - $30M",
        "FY25 Forecasted Spend": 1388000,
        "FY25 Actual Spend": 166800,
        "Project Summary": "A statewide initiative by the Department of Natural Resources (DNR) to replace the COMPASS system with a modern, web-based Commercial Off-the-Shelf (COTS) platform for comprehensive licensing and permitting services."
    },
    {
        "MITDP ID": "MDH-16-EHR",
        "Name": "Statewide Electronic Health Records (EHR) system",
        "Agency": "Maryland Department of Health",
        "Phase": "Implementation",
        "Project Length": "6 - 8 years",
        "End Year": 2029,
        "Project Time Remaining": "1 to 3 years",
        "Procurement Start": "8/6/2021", "Procurement End": "10/1/2023",
        "Implementation Start": "10/2/2023", "Implementation End": "12/31/2026",
        "O&M Start": "1/1/2027", "O&M End": "3/31/2028",
        "EAC": "$30M - $40M",
        "FY25 Forecasted Spend": 6276198.99,
        "FY25 Actual Spend": 5852884,
        "Project Summary": "A Maryland Department of Health (MDH) initiative to replace the legacy Health Management Information System with a commercially available, cloud-based Software as a Service (SaaS) solution."
    }
];

    // --- Chart Setup ---
    let spendChart;
    
    function initChart() {
        const ctx = document.getElementById('spendChart').getContext('2d');
        spendChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Forecasted Spend', 'Actual Spend'],
                datasets: [{
                    label: 'USD ($)',
                    data: [0, 0],
                    backgroundColor: ['#f6ad55', '#2c5282'],
                    borderRadius: 4,
                    barPercentage: 0.6
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return '$' + (value / 1000000).toFixed(1) + 'M';
                            }
                        }
                    }
                }
            }
        });
    }

    // --- Logic ---
    
    const dropdown = document.getElementById('projectSelect');

    function populateDropdown() {
        projectsData.forEach((p, index) => {
            const option = document.createElement('option');
            option.value = index;
            option.text = `[${p["MITDP ID"]}] ${p.Name}`;
            dropdown.appendChild(option);
        });
    }

    function parseDate(dateStr) {
        if(!dateStr) return null;
        return new Date(dateStr);
    }

    function loadProject(index) {
        const project = projectsData[index];

        // 1. Update Text Fields
        document.getElementById('eacDisplay').innerText = project.EAC;
        document.getElementById('agencyDisplay').innerText = project.Agency;
        document.getElementById('phaseDisplay').innerText = project.Phase;
        document.getElementById('idDisplay').innerText = project["MITDP ID"];
        document.getElementById('summaryDisplay').innerText = project["Project Summary"];
        
        // 2. Update Timeline Metrics
        document.getElementById('lengthDisplay').innerText = project["Project Length"];
        document.getElementById('remainingDisplay').innerText = project["Project Time Remaining"];
        document.getElementById('endYearDisplay').innerText = project["End Year"];

        // 3. Update Chart (FY25 data)
        const forecast = parseFloat(project["FY25 Forecasted Spend"]);
        const actual = parseFloat(project["FY25 Actual Spend"]);
        
        spendChart.data.datasets[0].data = [forecast, actual];
        spendChart.update();

        // 4. Update Timeline Visualization
        drawTimeline(project);
    }

    function drawTimeline(project) {
        const track = document.getElementById('timelineTrack');
        track.innerHTML = ''; // Clear previous

        // Timeline range: 2016 to 2030
        const minYear = 2016;
        const maxYear = 2030;
        const totalSpan = maxYear - minYear;

        // Helper to calculate % position
        const getPos = (dateStr) => {
            const d = parseDate(dateStr);
            if(!d) return 0;
            const year = d.getFullYear() + (d.getMonth() / 12);
            return ((year - minYear) / totalSpan) * 100;
        };

        const phases = [
            { start: project["Procurement Start"], end: project["Procurement End"], color: 'var(--procurement-color)', label: 'Proc' },
            { start: project["Implementation Start"], end: project["Implementation End"], color: 'var(--implementation-color)', label: 'Imp' },
            { start: project["O&M Start"], end: project["O&M End"], color: 'var(--om-color)', label: 'O&M' }
        ];

        phases.forEach(phase => {
            const startPct = getPos(phase.start);
            const endPct = getPos(phase.end);
            const widthPct = endPct - startPct;

            if (widthPct > 0) {
                const bar = document.createElement('div');
                bar.className = 'phase-bar';
                bar.style.left = startPct + '%';
                bar.style.width = widthPct + '%';
                bar.style.backgroundColor = phase.color;
                // Add tooltip title
                bar.title = `${phase.label}: ${phase.start} - ${phase.end}`;
                track.appendChild(bar);
            }
        });
    }

    // --- Initialization ---
    window.onload = function() {
        initChart();
        populateDropdown();
        loadProject(1); // Load default project (e.g., index 1 to match data variety)
    };

</script>
</body>
</html>